flowchart TD
    A["ğŸ¤– Cloud Run Job<br/>(Data Generator)"] -->|"Pub/Sub Messages"| B[("â˜ï¸ Pub/Sub Topic<br/>sensor-readings")]
    
    C["â° Cloud Scheduler"] -->|"Triggers"| D["ğŸ”„ Cloud Workflows<br/>(Pipeline Orchestration)"]
    
    B -->|"Pull Messages"| D
    D --> D1["ğŸ“¥ Ingest Function<br/>(Pub/Sub â†’ BigQuery)"]
    D1 --> E[("ğŸ¢ BigQuery<br/>Dataset: iot_pipeline")]
    
    D --> D2["ğŸ”„ dbt Cloud Job<br/>(Transform Models)"]
    D2 --> E
    
    E --> E1["ğŸ“Š raw_sensor_readings<br/>(Raw Data)"]
    E --> E2["ğŸ“ˆ fact_readings<br/>(Hourly Aggregates)"]
    E --> E3["ğŸ·ï¸ dim_sensors<br/>(Sensor Dimension)"]
    
    E --> F["ğŸ“± Cloud Run App<br/>(Streamlit Dashboard)"]
    F --> F1["ğŸ“Š Interactive Charts"]
    F --> F2["ğŸš¨ Real-time Anomalies"]
    F --> F3["ğŸ“‹ Live Status"]
    
    G["ğŸ” Cloud IAM"] -.->|"Manages Access"| H["ğŸ”‘ Service Accounts"]
    I["ğŸ“Š Cloud Monitoring"] -.->|"Tracks Costs"| J["ğŸ’° Budget Alerts"]
    
    K["ğŸš€ GitHub Actions"] -.->|"CI/CD Deploy"| F
    K -.-> A
    
    style A fill:#e3f2fd
    style B fill:#fff3e0
    style D fill:#f3e5f5
    style E fill:#e8f5e8
    style F fill:#fff8e1
    style G fill:#fce4ec
